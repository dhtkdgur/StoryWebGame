<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ÎÇ¥ ÏπúÍµ¨Ïùò ÏÇ¨ÏÉùÌôú</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Î©îÎâ¥ Î≤ÑÌäº (ÏÉÅÎã® ÏôºÏ™Ω) -->
  <button id="menu-toggle" class="menu-toggle-btn" title="Î©îÎâ¥">
    <span class="menu-icon">‚ò∞</span>
  </button>

  <!-- Î©îÎâ¥ Ìå®ÎÑê -->
  <div id="menu-panel" class="menu-panel hidden">
    <div class="menu-header">
      <h3>ÏÑ§Ï†ï</h3>
      <button id="menu-close" class="menu-close-btn">‚úï</button>
    </div>
    <div class="menu-content">
      <!-- ÎßàÏä§ÌÑ∞ ÏùåÎüâ Ï°∞Ï†à -->
      <div class="menu-item">
        <label class="menu-label">üîä Î™®Îì† ÏùåÎüâ</label>
        <button id="master-mute-toggle" class="mute-toggle-btn">ON</button>
      </div>

      <!-- BGM Î≥ºÎ•® ÏÑ§Ï†ï -->
      <div class="menu-item">
        <label for="bgm-volume">
          <span class="menu-label">üéµ BGM Î≥ºÎ•®</span>
          <span id="bgm-volume-value" class="volume-value">30%</span>
        </label>
        <input type="range" id="bgm-volume" class="volume-slider" min="0" max="100" value="30">
      </div>

      <!-- Ìö®Í≥ºÏùå Î≥ºÎ•® ÏÑ§Ï†ï -->
      <div class="menu-item">
        <label for="sfx-volume">
          <span class="menu-label">üîî Ìö®Í≥ºÏùå Î≥ºÎ•®</span>
          <span id="sfx-volume-value" class="volume-value">50%</span>
        </label>
        <input type="range" id="sfx-volume" class="volume-slider" min="0" max="100" value="50">
      </div>
    </div>
  </div>

  <!-- Î©îÎâ¥ Ïò§Î≤ÑÎ†àÏù¥ (Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞) -->
  <div id="menu-overlay" class="menu-overlay hidden"></div>

  <!-- Î°úÍ≥† (Î™®Îì† ÌôîÎ©¥ÏóêÏÑú ÎèôÏùºÌïú ÏúÑÏπò) -->
  <img class="site-logo" src="/image/00_Ï†ÑÏ≤¥/Î°úÍ≥†.png" alt="StoryWebGame Î°úÍ≥†">

  <div id="app">

    <!-- 1. ÏûÖÏû• ÌôîÎ©¥ (JS: screen-name) -->
    <section id="screen-name" class="screen">
      <div class="entry-container">
        <img class="screen-frame-bg" src="/image/01_Î©îÏù∏ÌôîÎ©¥/Rectangle 70.png" alt="Î∞∞Í≤Ω ÌîÑÎ†àÏûÑ">
        <img class="main-note-bg" src="/image/01_Î©îÏù∏ÌôîÎ©¥/Main_Note(WhiteBorder).png" alt="Î©îÏù∏ ÎÖ∏Ìä∏ Î∞∞Í≤Ω">
        <div class="entry-content">
          <!-- ÏôºÏ™Ω: ÏïÑÎ∞îÌÉÄ ÏÑ†ÌÉù + ÎãâÎÑ§ÏûÑ ÏûÖÎ†• -->
          <div class="entry-left">
            <div class="avatar-preview-container">
              <p class="subtitle">ÏÑ†ÌÉùÌïú ÏïÑÎ∞îÌÉÄ</p>
              <div class="avatar-wrapper">
                <div id="avatar-preview" class="avatar-preview"></div>
                <button id="btn-random-avatar" class="random-btn">
                  <img src="./image/01_Î©îÏù∏ÌôîÎ©¥/reroll.png" alt="ÎûúÎç§ Î≥ÄÍ≤Ω" style="width: 40px; height: 40px;">
                </button>
              </div>
            </div>
            <div class="avatar-selection">
              <p class="subtitle">ÏïÑÎ∞îÌÉÄ ÏÑ†ÌÉù</p>
              <div id="avatar-list" class="avatar-list"></div>
            </div>
            <div class="nickname-section">
              <p class="subtitle">ÎãâÎÑ§ÏûÑ</p>
              <div class="nickname-label-wrapper">
                <img src="/image/01_Î©îÏù∏ÌôîÎ©¥/ÏûëÏùÄÍ≤¨Ï∂úÏßÄ.png" alt="Í≤¨Ï∂úÏßÄ" class="nickname-label-bg">
                <input id="input-nickname" placeholder="ÎãâÎÑ§ÏûÑ ÏûÖÎ†•" maxlength="10">
              </div>
            </div>
          </div>

          <!-- Ïò§Î•∏Ï™Ω: Í≤åÏûÑÌò∏Ïä§Ìä∏, Í≤åÏûÑÏûÖÏû• Î≤ÑÌäº -->
          <div class="entry-right">
            <div class="entry-buttons">
              <button id="btn-create-room" class="image-btn">
                <img src="/image/01_Î©îÏù∏ÌôîÎ©¥/Í≤åÏûÑÌò∏Ïä§Ìä∏Î≤ÑÌäº.png" alt="Î∞© ÎßåÎì§Í∏∞">
              </button>
              <button id="btn-join-room" class="image-btn">
                <img src="/image/01_Î©îÏù∏ÌôîÎ©¥/Í≤åÏûÑÏûÖÏû•ÌïòÍ∏∞Î≤ÑÌäº.png" alt="Î∞© Îì§Ïñ¥Í∞ÄÍ∏∞">
                
                <!-- Ìè¨Ïä§Ìä∏Ïûá ÏúÑÏóê Îú®Îäî ÏûÖÎ†• UI (Ï≤òÏùåÏóî hidden) -->
                <div id="join-inline" class="join-inline hidden">
                  <div class="join-inline-title">Î∞© ÏΩîÎìú ÏûÖÎ†•</div>
                  <input id="input-room-code-inline" placeholder="Ïòà: 12345" autocomplete="off" />

                  <div class="join-inline-actions">
                    <button id="btn-join-inline" type="button" class="image-btn hidden">
                    <img src="/image/01_Î©îÏù∏ÌôîÎ©¥/ÏûÖÏû•ÌïòÍ∏∞.png" alt="ÏûÖÏû•ÌïòÍ∏∞">
                    </button>
                  </div>
                </div>
        
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 2. Î∞© ÏΩîÎìú ÏûÖÎ†• (JS: screen-waiting) -->
    <section id="screen-waiting" class="screen hidden">
      <div class="card">
        <button id="btn-close-waiting" type="button" class="waiting-close" aria-label="Îã´Í∏∞">√ó</button>

        <h2>Î∞© ÏΩîÎìú ÏûÖÎ†•</h2>
        <input id="input-room-code" placeholder="Ïòà: 12345" autocomplete="off" />
        <button id="btn-join">Go!</button>
      </div>
    </section>


    <!-- Ïπ¥Ïö¥Ìä∏Îã§Ïö¥ ÌôîÎ©¥ -->
    <section id="screen-countdown" class="screen hidden">
      <div class="card" style="text-align:center;">
        <h2 style="margin-bottom:12px;">ÏπúÍµ¨Ïùò ÏùºÍ∏∞Ïû• ÏÜçÏúºÎ°ú...</h2>
        <div id="countdown-number" style="font-size:72px; font-weight:800;">3</div>
      </div>
    </section>


    <!-- 3. Î°úÎπÑ -->
    <section id="screen-lobby" class="screen hidden">
      <div class="lobby-container">
        <img class="screen-frame-bg" src="/image/01_Î©îÏù∏ÌôîÎ©¥/Rectangle 70.png" alt="Î∞∞Í≤Ω ÌîÑÎ†àÏûÑ">
        <img src="/image/02_Î°úÎπÑ/Í≥µÏ±Ö.png" alt="Î°úÎπÑ Í≥µÏ±Ö Î∞∞Í≤Ω" class="lobby-note-bg">
        <img src="./image/02_Î°úÎπÑ/ÎåÄÍ∏∞Ïã§.png" alt="ÎåÄÍ∏∞Ïã§" class="lobby-tag">

        <div class="lobby-left">
          <h2>
            Ï∞∏Í∞ÄÏûê Î™©Î°ù (
            <span id="player-count">1</span>
            /
            <span id="player-max">12</span>
            )
          </h2>
          
          <img src="./image/02_Î°úÎπÑ/Ï∞∏Í∞ÄÏûêÎ™©Î°ù Íµ¨Î∂ÑÏÑ†.png" class="divider-img" style="margin-bottom: 15px;">
          
          <div id="player-list" class="player-list-vertical">
            
            <div class="player-row">
              <div class="player-info">
                <img src="./image/02_Î°úÎπÑ/ÏïÑÎ∞îÌÉÄ_Ï∞∏Í∞ÄÏûê.png" class="player-avatar-img">
                <span class="player-name">ÏßúÌååÍ≤åÌã∞ÌååÌã∞</span>
                <img src="./image/02_Î°úÎπÑ/Î∞©Ïû•ÏôïÍ¥Ä.png" class="host-icon" alt="Î∞©Ïû•">
              </div>
              <img src="./image/02_Î°úÎπÑ/Ï∞∏Í∞ÄÏûêÎ™©Î°ù Íµ¨Î∂ÑÏÑ†.png" class="divider-img">
            </div>

            <div class="player-row">
              <div class="player-info">
                <img src="./image/02_Î°úÎπÑ/ÏïÑÎ∞îÌÉÄ_Ï∞∏Í∞ÄÏûê.png" class="player-avatar-img">
                <span class="player-name">ÎëêÌè∞Ïø†ÎÇ¥ÎÜî</span>
              </div>
              <img src="./image/02_Î°úÎπÑ/Ï∞∏Í∞ÄÏûêÎ™©Î°ù Íµ¨Î∂ÑÏÑ†.png" class="divider-img">
            </div>

            <div class="player-row empty">
              <div class="player-info">
                <img src="./image/02_Î°úÎπÑ/ÏïÑÎ∞îÌÉÄ_Îπà Ï∞∏Í∞ÄÏûê.png" class="player-avatar-img">
                <span class="player-name" style="color:#999;">Îπà ÏûêÎ¶¨</span>
              </div>
              <img src="./image/02_Î°úÎπÑ/Ï∞∏Í∞ÄÏûêÎ™©Î°ù Íµ¨Î∂ÑÏÑ†.png" class="divider-img">
            </div>

          </div>
        </div>

        <div class="lobby-right">
          
          <div id="host-controls">
            <button id="btn-start" class="image-btn">
              <img src="./image/02_Î°úÎπÑ/ÏãúÏûëÌïòÍ∏∞ Î≤ÑÌäº.png" alt="ÏãúÏûëÌïòÍ∏∞">
            </button>
          </div>

          <div class="room-code-container" id="room-code-btn">
            <img src="./image/02_Î°úÎπÑ/Î∞© ÏΩîÎìú Î≤ÑÌäº.png" alt="Î∞© ÏΩîÎìú" class="room-code-img">
            <img src="./image/02_Î°úÎπÑ/Î∞© ÏΩîÎìú_Ìò∏Î≤Ñ Ïãú_Î≥µÏÇ¨ÌïòÍ∏∞ Î≤ÑÌäº.png" alt="Î≥µÏÇ¨ÌïòÍ∏∞" class="room-code-hover-img">
            <span id="display-room-code" class="room-code-text">Î∞© ÏΩîÎìú: 0000</span>
          </div>

          <button id="btn-leave" class="image-btn">
            <img src="./image/02_Î°úÎπÑ/ÎÇòÍ∞ÄÍ∏∞ Î≤ÑÌäº.png" alt="ÎÇòÍ∞ÄÍ∏∞">
          </button>

          <p id="wait-msg-lobby">Î∞©Ïû•Ïù¥ Í≤åÏûÑÏùÑ ÏãúÏûëÌïòÍ∏∏ Í∏∞Îã§Î¶¨Îäî Ï§ë ...</p>
        </div>

      </div>
    </section>

    <!-- 4. Ïπ¥Îìú ÏûÖÎ†• -->
    <section id="screen-prompts" class="screen hidden">
      <div class="prompts-layout">
        <img class="screen-frame-bg" src="/image/01_Î©îÏù∏ÌôîÎ©¥/Rectangle 70.png" alt="Î∞∞Í≤Ω ÌîÑÎ†àÏûÑ">
        <!-- ÏôºÏ™Ω ÌîåÎ†àÏù¥Ïñ¥ ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <div id="prompts-players-left" class="player-sidebar player-sidebar-left"></div>

        <!-- Ï§ëÏïô Í≤åÏûÑ ÏòÅÏó≠ -->
        <div class="prompts-main">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <div id="display-prompt-timer">60s</div>
          </div>

          <div class="prompt-container">
            <div class="note-background">
              <div class="keyword-cards-wrapper">
                <div class="keyword-card">
                  <img src="/image/03_ÌÇ§ÏõåÎìú Ï†ÅÍ∏∞/Ïπ¥Îìú1.png" alt="Ïπ¥Îìú1">
                  <input type="text" class="input-prompt" placeholder="ÏΩîÎî©ÌïòÎäî Í∏∞ÌõàÏù¥">
                </div>
                <div class="keyword-card">
                  <img src="/image/03_ÌÇ§ÏõåÎìú Ï†ÅÍ∏∞/Ïπ¥Îìú2.png" alt="Ïπ¥Îìú2">
                  <input type="text" class="input-prompt" placeholder="ÎπÑÎ∞ÄÏùò Î∞©">
                </div>
                <div class="keyword-card">
                  <img src="/image/03_ÌÇ§ÏõåÎìú Ï†ÅÍ∏∞/Ïπ¥Îìú3.png" alt="Ïπ¥Îìú3">
                  <input type="text" class="input-prompt" placeholder="ÎßàÎ≤ïÏùò Ï£ºÎ¨∏">
                </div>
              </div>
            </div>
          </div>

          <button id="btn-submit-prompts" class="image-btn">
            <img src="/image/03_ÌÇ§ÏõåÎìú Ï†ÅÍ∏∞/ÌôïÏù∏.png" alt="ÏûëÏÑ± ÏôÑÎ£å">
          </button>
          <p id="wait-msg" class="hidden">Îã§Î•∏ ÌîåÎ†àÏù¥Ïñ¥Îì§ÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë...</p>
        </div>

        <!-- Ïò§Î•∏Ï™Ω ÌîåÎ†àÏù¥Ïñ¥ ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <div id="prompts-players-right" class="player-sidebar player-sidebar-right"></div>
      </div>

      <!-- Î∞õÏùÄ Ïù¥Î™®Ìã∞ÏΩò ÌëúÏãú (ÌÇ§ÏõåÎìú ÌôîÎ©¥Ïö©) -->
      <div id="prompts-emoji-display" class="emoji-display"></div>

      <!-- ÌîåÎ†àÏù¥Ïñ¥ ÏûëÏÑ± ÏÉÅÌÉú (Ïà®ÍπÄ - ÏÇ¨Ïù¥ÎìúÎ∞îÏóêÏÑú ÌëúÏãú) -->
      <div id="prompt-status-container" class="hidden">
        <div id="prompt-status-list" class="player-status-list"></div>
      </div>
    </section>

    <!-- 5. Ïä§ÌÜ†Î¶¨ Ïù¥Ïñ¥Ïì∞Í∏∞ -->
    <section id="screen-story" class="screen hidden">
      <div class="story-layout">
        <img class="screen-frame-bg" src="/image/01_Î©îÏù∏ÌôîÎ©¥/Rectangle 70.png" alt="Î∞∞Í≤Ω ÌîÑÎ†àÏûÑ">
        <div id="players-left" class="player-sidebar player-sidebar-left"></div>

        <div class="story-main">
          <div class="notebook-panel">
            
            <div class="notebook-header">
              <div class="round-info">
                <span id="display-round">1</span> / <span id="display-total-rounds">12</span>
              </div>
              <div class="timer-info">
                <span id="display-timer">30s</span>
              </div>
            </div>

            <div class="notebook-body">
              <div id="story-so-far" class="story-so-far-text"></div>

              <div id="my-inbox-prompts" class="sticky-note-container"></div>
            </div>

            <div class="notebook-footer">
              <div class="input-area-wrapper">
                <span class="quote-mark left">"</span>
                
                <div class="input-bg-container">
                  <img src="/image/04_Ïä§ÌÜ†Î¶¨ Ï†ÅÍ∏∞/ÏûÖÎ†•ÎûÄ.png" alt="ÏûÖÎ†•ÎûÄ" class="input-line-img">
                  <textarea
                    id="input-story-text"
                    rows="2"
                    placeholder="Ïó¨Í∏∞Ïóê Î¨∏Ïû•ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                  ></textarea>
                </div>

                <span class="quote-mark right">"</span>
                
                <button id="btn-submit-story" class="plane-submit-btn">
                  <img src="/image/04_Ïä§ÌÜ†Î¶¨ Ï†ÅÍ∏∞/Ï†úÏ∂ú.png" alt="Ï†úÏ∂ú">
                </button>
              </div>
              
              <p id="story-wait-msg" class="hidden">Îã§Î•∏ ÌîåÎ†àÏù¥Ïñ¥Îì§ÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë...</p>
            </div>

          </div>
        </div>

        <div id="players-right" class="player-sidebar player-sidebar-right"></div>
      </div>

      <div id="player-status-container" class="player-status-container hidden">
        <div id="player-status-list" class="player-status-list"></div>
      </div>

      <div id="emoji-display" class="emoji-display"></div>
    </section>

<section id="screen-results" class="screen hidden">
  <div class="results-frame">
    <img class="screen-frame-bg" src="/image/01_Î©îÏù∏ÌôîÎ©¥/Rectangle 70.png" alt="Î∞∞Í≤Ω ÌîÑÎ†àÏûÑ">

    <!-- ÏôºÏ™Ω ÏÇ¨Ïù¥ÎìúÎ∞î: Ïù¥Î™®Ìã∞ÏΩò ÌîºÏª§ + Î≥∏Ïù∏ ÌîÑÎ°úÌïÑ -->
    <aside class="results-left-panel">
      <div id="results-players-left" class="player-sidebar player-sidebar-left"></div>
    </aside>

    <!-- Í∞ÄÏö¥Îç∞: Í≥µÏ±Ö(Ï±ÑÌåÖ) -->
    <main class="results-center">
      <div class="results-container">
        <div id="story-title" class="story-title"></div>

        <div id="story-progress" class="story-progress">
          <span id="progress-text"></span>
        </div>

        <div id="chat-container" class="chat-container"></div>
      </div>

      <!-- Ïò§Î•∏Ï™Ω: Ìè¨Ïä§Ìä∏Ïûá Î≤ÑÌäºÎì§ -->
      <aside class="results-right-panel">
        <div class="results-side-controls results-side-controls--stack">

          <button id="btn-exit" class="result-side-btn">
            <img src="/image/05_ÏóîÎî©/Í≤åÏûÑ ÎÇòÍ∞ÄÍ∏∞.png" alt="Í≤åÏûÑ ÎÇòÍ∞ÄÍ∏∞">
          </button>

          <button id="btn-restart" class="result-side-btn">
            <img src="/image/05_ÏóîÎî©/Îã§ÏãúÌïòÍ∏∞.png" alt="Îã§ÏãúÌïòÍ∏∞">
          </button>

          <button id="btn-screenshot" class="result-side-btn">
            <img src="/image/05_ÏóîÎî©/Ï†ÄÏû•ÌïòÍ∏∞.png" alt="Ï†ÄÏû•ÌïòÍ∏∞">
          </button>

          <button id="btn-prev" class="result-side-btn">
            <img src="/image/05_ÏóîÎî©/Ïù¥Ï†Ñ Ïù¥ÏïºÍ∏∞Î°ú.png" alt="Ïù¥Ï†Ñ Ïù¥ÏïºÍ∏∞Î°ú">
          </button>

          <button id="btn-next-story" class="result-side-btn">
            <img src="/image/05_ÏóîÎî©/Îã§Ïùå Ïù¥ÏïºÍ∏∞Î°ú.png" alt="Îã§Ïùå Ïù¥ÏïºÍ∏∞Î°ú">
          </button>

        </div>
      </aside>
    </main>

  </div>

  <!-- Í≤∞Í≥º ÌôîÎ©¥ Ïù¥Î™®Ìã∞ÏΩò Ïï†ÎãàÎ©îÏù¥ÏÖò Ïª®ÌÖåÏù¥ÎÑà (ÌôîÎ©¥ Ï†ÑÏ≤¥Ïóê ÌëúÏãú) -->
  <div id="result-emoji-container" class="result-emoji-container"></div>
</section>


  <!-- BGM Î∞è Ìö®Í≥ºÏùå -->
  <audio id="bgm" loop>
    <source src="/image/00_Ï†ÑÏ≤¥/background_v2.mp3" type="audio/mpeg">
  </audio>

  <!-- Ìö®Í≥ºÏùå -->
  <audio id="sfx-click">
    <source src="/sound/click_02.wav" type="audio/wav">
  </audio>
  <audio id="sfx-enter">
    <source src="/sound/enter.mp3" type="audio/mpeg">
  </audio>
  <audio id="sfx-error">
    <source src="/sound/error_02.wav" type="audio/wav">
  </audio>
  <audio id="sfx-next-turn">
    <source src="/sound/next_turn.wav" type="audio/wav">
  </audio>
  <audio id="sfx-time-up">
    <source src="/sound/time_up_02.wav" type="audio/wav">
  </audio>
  <audio id="sfx-before-timeout">
    <source src="/sound/before_time_out_5s.wav" type="audio/wav">
  </audio>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="sound-config.js"></script>
  <script src="script.js"></script>
</body>
</html>